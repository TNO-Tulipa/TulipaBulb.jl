<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Tutorial · TulipaEnergyModel.jl</title><meta name="title" content="Tutorial · TulipaEnergyModel.jl"/><meta property="og:title" content="Tutorial · TulipaEnergyModel.jl"/><meta property="twitter:title" content="Tutorial · TulipaEnergyModel.jl"/><meta name="description" content="Documentation for TulipaEnergyModel.jl."/><meta property="og:description" content="Documentation for TulipaEnergyModel.jl."/><meta property="twitter:description" content="Documentation for TulipaEnergyModel.jl."/><meta property="og:url" content="https://TulipaEnergy.github.io/TulipaEnergyModel.jl/tutorial/"/><meta property="twitter:url" content="https://TulipaEnergy.github.io/TulipaEnergyModel.jl/tutorial/"/><link rel="canonical" href="https://TulipaEnergy.github.io/TulipaEnergyModel.jl/tutorial/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">TulipaEnergyModel.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../mathematical-formulation/">Mathematical Formulation</a></li><li><a class="tocitem" href="../how-to-use/">How to Use</a></li><li><a class="tocitem" href="../api/">API</a></li><li class="is-active"><a class="tocitem" href>Tutorial</a><ul class="internal"><li><a class="tocitem" href="#basic-example"><span>Basic example</span></a></li><li><a class="tocitem" href="#graph-tutorial"><span>Using the graph structure</span></a></li><li><a class="tocitem" href="#solution-tutorial"><span>Manipulating the solution</span></a></li></ul></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Tutorial</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Tutorial</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/TulipaEnergy/TulipaEnergyModel.jl/blob/main/docs/src/tutorial.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="tutorial"><a class="docs-heading-anchor" href="#tutorial">Tutorial</a><a id="tutorial-1"></a><a class="docs-heading-anchor-permalink" href="#tutorial" title="Permalink"></a></h1><p>Here are some tutorials on how to use Tulipa.</p><h2 id="basic-example"><a class="docs-heading-anchor" href="#basic-example">Basic example</a><a id="basic-example-1"></a><a class="docs-heading-anchor-permalink" href="#basic-example" title="Permalink"></a></h2><p>For our first example, let&#39;s use a very small existing dataset. Inside the code for this package, you can find the folder <a href="https://github.com/TulipaEnergy/TulipaEnergyModel.jl/tree/main/test/inputs/Tiny"><code>test/inputs/Tiny</code></a>, which includes all the files necessary to create a TulipaEnergyModel and solve it.</p><p>There are 7 files inside the &quot;Tiny&quot; folder. They define the assets and flows data, their profiles, and their time resolution. Furthermore, there is a file to define the representative periods. For more details on what are these files mean, see <a href="../how-to-use/#Input">Input</a></p><h3 id="Run-scenario"><a class="docs-heading-anchor" href="#Run-scenario">Run scenario</a><a id="Run-scenario-1"></a><a class="docs-heading-anchor-permalink" href="#Run-scenario" title="Permalink"></a></h3><p>To read all data from the Tiny folder, perform all necessary steps to create a model and solve it, use the following snippet:</p><pre><code class="language-julia hljs">using TulipaEnergyModel

# input_dir should be the path to Tiny
energy_problem = run_scenario(input_dir)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TulipaEnergyModel.EnergyProblem(Meta graph based on a Graphs.SimpleGraphs.SimpleDiGraph{Int64} with vertex labels of type String, vertex metadata of type GraphAssetData, edge metadata of type GraphFlowData, graph metadata given by nothing, and default weight nothing, RepresentativePeriod[RepresentativePeriod(73.0, 1:24, 1.0), RepresentativePeriod(182.5, 1:24, 1.0), RepresentativePeriod(109.5, 1:24, 1.0)], Dict{Tuple{String, Int64}, Vector{UnitRange{Int64}}}((&quot;ens&quot;, 2) =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:15, 16:16, 17:17, 18:18, 19:19, 20:20, 21:21, 22:22, 23:23, 24:24], (&quot;ocgt&quot;, 1) =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:15, 16:16, 17:17, 18:18, 19:19, 20:20, 21:21, 22:22, 23:23, 24:24], (&quot;solar&quot;, 1) =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:15, 16:16, 17:17, 18:18, 19:19, 20:20, 21:21, 22:22, 23:23, 24:24], (&quot;ccgt&quot;, 2) =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:15, 16:16, 17:17, 18:18, 19:19, 20:20, 21:21, 22:22, 23:23, 24:24], (&quot;wind&quot;, 2) =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:15, 16:16, 17:17, 18:18, 19:19, 20:20, 21:21, 22:22, 23:23, 24:24], (&quot;solar&quot;, 3) =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:15, 16:16, 17:17, 18:18, 19:19, 20:20, 21:21, 22:22, 23:23, 24:24], (&quot;solar&quot;, 2) =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:15, 16:16, 17:17, 18:18, 19:19, 20:20, 21:21, 22:22, 23:23, 24:24], (&quot;ocgt&quot;, 2) =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:15, 16:16, 17:17, 18:18, 19:19, 20:20, 21:21, 22:22, 23:23, 24:24], (&quot;ens&quot;, 3) =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:15, 16:16, 17:17, 18:18, 19:19, 20:20, 21:21, 22:22, 23:23, 24:24], (&quot;demand&quot;, 2) =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:15, 16:16, 17:17, 18:18, 19:19, 20:20, 21:21, 22:22, 23:23, 24:24]…), A JuMP Model
Minimization problem with:
Variables: 364
Objective function type: JuMP.AffExpr
`JuMP.AffExpr`-in-`MathOptInterface.EqualTo{Float64}`: 72 constraints
`JuMP.AffExpr`-in-`MathOptInterface.LessThan{Float64}`: 720 constraints
`JuMP.VariableRef`-in-`MathOptInterface.GreaterThan{Float64}`: 364 constraints
`JuMP.VariableRef`-in-`MathOptInterface.LessThan{Float64}`: 1 constraint
`JuMP.VariableRef`-in-`MathOptInterface.Integer`: 4 constraints
Model mode: AUTOMATIC
CachingOptimizer state: ATTACHED_OPTIMIZER
Solver name: HiGHS
Names registered in the model: assets_investment, assets_profile_times_capacity, consumer_balance, conversion_balance, energy_limit, flow, flow_max_capacity, flows_investment, hub_balance, incoming_flow, incoming_flow_w_efficiency, lower_bound_transport_flow, outgoing_flow, outgoing_flow_w_efficiency, overall_input_flows, overall_output_flows, storage_balance, storage_inflows, storage_level, transport_flow_lower_bound, transport_flow_upper_bound, upper_bound_asset, upper_bound_for_storage_level, upper_bound_transport_flow, true, 269238.4382415647, MathOptInterface.OPTIMAL)</code></pre><p>The <code>energy_problem</code> variable is of type <code>EnergyProblem</code>. For more details, see the <a href="../reference/#TulipaEnergyModel.EnergyProblem">documentation for that type</a>, or the section <a href="../how-to-use/#Structures">Structures</a>.</p><h3 id="Manually-running-each-step"><a class="docs-heading-anchor" href="#Manually-running-each-step">Manually running each step</a><a id="Manually-running-each-step-1"></a><a class="docs-heading-anchor-permalink" href="#Manually-running-each-step" title="Permalink"></a></h3><p>If we need more control, we can create the energy problem first, then the optimization model inside it, and finally ask for it to be solved.</p><pre><code class="language-julia hljs">using TulipaEnergyModel

# input_dir should be the path to Tiny
energy_problem = create_energy_problem_from_csv_folder(input_dir)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">TulipaEnergyModel.EnergyProblem(Meta graph based on a Graphs.SimpleGraphs.SimpleDiGraph{Int64} with vertex labels of type String, vertex metadata of type GraphAssetData, edge metadata of type GraphFlowData, graph metadata given by nothing, and default weight nothing, RepresentativePeriod[RepresentativePeriod(73.0, 1:24, 1.0), RepresentativePeriod(182.5, 1:24, 1.0), RepresentativePeriod(109.5, 1:24, 1.0)], Dict{Tuple{String, Int64}, Vector{UnitRange{Int64}}}((&quot;ens&quot;, 2) =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:15, 16:16, 17:17, 18:18, 19:19, 20:20, 21:21, 22:22, 23:23, 24:24], (&quot;ocgt&quot;, 1) =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:15, 16:16, 17:17, 18:18, 19:19, 20:20, 21:21, 22:22, 23:23, 24:24], (&quot;solar&quot;, 1) =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:15, 16:16, 17:17, 18:18, 19:19, 20:20, 21:21, 22:22, 23:23, 24:24], (&quot;ccgt&quot;, 2) =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:15, 16:16, 17:17, 18:18, 19:19, 20:20, 21:21, 22:22, 23:23, 24:24], (&quot;wind&quot;, 2) =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:15, 16:16, 17:17, 18:18, 19:19, 20:20, 21:21, 22:22, 23:23, 24:24], (&quot;solar&quot;, 3) =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:15, 16:16, 17:17, 18:18, 19:19, 20:20, 21:21, 22:22, 23:23, 24:24], (&quot;solar&quot;, 2) =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:15, 16:16, 17:17, 18:18, 19:19, 20:20, 21:21, 22:22, 23:23, 24:24], (&quot;ocgt&quot;, 2) =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:15, 16:16, 17:17, 18:18, 19:19, 20:20, 21:21, 22:22, 23:23, 24:24], (&quot;ens&quot;, 3) =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:15, 16:16, 17:17, 18:18, 19:19, 20:20, 21:21, 22:22, 23:23, 24:24], (&quot;demand&quot;, 2) =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:15, 16:16, 17:17, 18:18, 19:19, 20:20, 21:21, 22:22, 23:23, 24:24]…), nothing, false, NaN, MathOptInterface.OPTIMIZE_NOT_CALLED)</code></pre><p>The energy problem does not have a model yet:</p><pre><code class="language-julia hljs">energy_problem.model === nothing</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">true</code></pre><p>To create the internal model, we call the function <a href="../reference/#TulipaEnergyModel.create_model!-Tuple{Any}"><code>create_model!</code></a>.</p><pre><code class="language-julia hljs">create_model!(energy_problem)
energy_problem.model</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">A JuMP Model
Minimization problem with:
Variables: 364
Objective function type: JuMP.AffExpr
`JuMP.AffExpr`-in-`MathOptInterface.EqualTo{Float64}`: 72 constraints
`JuMP.AffExpr`-in-`MathOptInterface.LessThan{Float64}`: 720 constraints
`JuMP.VariableRef`-in-`MathOptInterface.GreaterThan{Float64}`: 364 constraints
`JuMP.VariableRef`-in-`MathOptInterface.LessThan{Float64}`: 1 constraint
`JuMP.VariableRef`-in-`MathOptInterface.Integer`: 4 constraints
Model mode: AUTOMATIC
CachingOptimizer state: EMPTY_OPTIMIZER
Solver name: HiGHS
Names registered in the model: assets_investment, assets_profile_times_capacity, consumer_balance, conversion_balance, energy_limit, flow, flow_max_capacity, flows_investment, hub_balance, incoming_flow, incoming_flow_w_efficiency, lower_bound_transport_flow, outgoing_flow, outgoing_flow_w_efficiency, overall_input_flows, overall_output_flows, storage_balance, storage_inflows, storage_level, transport_flow_lower_bound, transport_flow_upper_bound, upper_bound_asset, upper_bound_for_storage_level, upper_bound_transport_flow</code></pre><p>The model has not been solved yet, which can be verified through the <code>solved</code> flag inside the energy problem:</p><pre><code class="language-julia hljs">energy_problem.solved</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">false</code></pre><p>Finally, we can solve the model:</p><pre><code class="language-julia hljs">solution = solve_model!(energy_problem)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(objective_value = 269238.4382415647, assets_investment = 1-dimensional DenseAxisArray{Float64,1,...} with index sets:
    Dimension 1, [&quot;ocgt&quot;, &quot;ccgt&quot;, &quot;wind&quot;, &quot;solar&quot;]
And data, a 4-element Vector{Float64}:
  0.0
  2.0
 35.0
 45.0, flow =   [(&quot;ccgt&quot;, &quot;demand&quot;), 1, 17:17 ]  =  525.5
  [(&quot;ccgt&quot;, &quot;demand&quot;), 1, 1:1   ]  =  757.5
  [(&quot;ccgt&quot;, &quot;demand&quot;), 1, 2:2   ]  =  677.5
  [(&quot;ccgt&quot;, &quot;demand&quot;), 1, 5:5   ]  =  583.0
  [(&quot;ccgt&quot;, &quot;demand&quot;), 2, 7:7   ]  =  0.0
  [(&quot;ccgt&quot;, &quot;demand&quot;), 3, 18:18 ]  =  0.0
  [(&quot;ens&quot;, &quot;demand&quot;), 2, 5:5    ]  =  0.0
  [(&quot;ens&quot;, &quot;demand&quot;), 3, 8:8    ]  =  0.0
                                   ⋮
  [(&quot;ocgt&quot;, &quot;demand&quot;), 1, 23:23 ]  =  -2.27374e-13
  [(&quot;ocgt&quot;, &quot;demand&quot;), 1, 3:3   ]  =  -9.80944e-14
  [(&quot;ocgt&quot;, &quot;demand&quot;), 3, 19:19 ]  =  0.0
  [(&quot;solar&quot;, &quot;demand&quot;), 1, 6:6  ]  =  9.0
  [(&quot;solar&quot;, &quot;demand&quot;), 1, 9:9  ]  =  225.0
  [(&quot;solar&quot;, &quot;demand&quot;), 3, 22:22]  =  0.0
  [(&quot;wind&quot;, &quot;demand&quot;), 3, 12:12 ]  =  793.5, flows_investment = 1-dimensional DenseAxisArray{Float64,1,...} with index sets:
    Dimension 1, Tuple{String, String}[]
And data, a 0-element Vector{Float64}, storage_level = JuMP.Containers.SparseAxisArray{Any, 3, Tuple{Any, Any, Any}} with 0 entries)</code></pre><p>The solution is included in the individual assets and flows, but for completeness, we return the full <code>solution</code> object, also defined in the <a href="../how-to-use/#Structures">Structures</a> section.</p><p>In particular, the objective value and the termination status are also included in the energy problem:</p><pre><code class="language-julia hljs">energy_problem.objective_value, energy_problem.termination_status</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(269238.4382415647, MathOptInterface.OPTIMAL)</code></pre><h3 id="Manually-creating-all-structures-without-EnergyProblem"><a class="docs-heading-anchor" href="#Manually-creating-all-structures-without-EnergyProblem">Manually creating all structures without EnergyProblem</a><a id="Manually-creating-all-structures-without-EnergyProblem-1"></a><a class="docs-heading-anchor-permalink" href="#Manually-creating-all-structures-without-EnergyProblem" title="Permalink"></a></h3><p>For additional control, it might be desirable to use the internal structures of <code>EnergyProblem</code> directly. This can be error prone, but it is slightly more efficient. The full description for these structures can be found in <a href="../how-to-use/#Structures">Structures</a>.</p><pre><code class="language-julia hljs">using TulipaEnergyModel

# input_dir should be the path to Tiny
graph, representative_periods = create_graph_and_representative_periods_from_csv_folder(input_dir)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(Meta graph based on a Graphs.SimpleGraphs.SimpleDiGraph{Int64} with vertex labels of type String, vertex metadata of type GraphAssetData, edge metadata of type GraphFlowData, graph metadata given by nothing, and default weight nothing, RepresentativePeriod[RepresentativePeriod(73.0, 1:24, 1.0), RepresentativePeriod(182.5, 1:24, 1.0), RepresentativePeriod(109.5, 1:24, 1.0)])</code></pre><p>To create the model we also need a time partition for the constraints. Creating an energy problem automatically computes this data, but since we are doing it manually, we need to compute it ourselves.</p><pre><code class="language-julia hljs">constraints_partitions = compute_constraints_partitions(graph, representative_periods)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Dict{Tuple{String, Int64}, Vector{UnitRange{Int64}}} with 18 entries:
  (&quot;ens&quot;, 2)    =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:1…
  (&quot;ocgt&quot;, 1)   =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:1…
  (&quot;solar&quot;, 1)  =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:1…
  (&quot;ccgt&quot;, 2)   =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:1…
  (&quot;wind&quot;, 2)   =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:1…
  (&quot;solar&quot;, 3)  =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:1…
  (&quot;solar&quot;, 2)  =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:1…
  (&quot;ocgt&quot;, 2)   =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:1…
  (&quot;ens&quot;, 3)    =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:1…
  (&quot;demand&quot;, 2) =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:1…
  (&quot;ocgt&quot;, 3)   =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:1…
  (&quot;ccgt&quot;, 3)   =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:1…
  (&quot;wind&quot;, 3)   =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:1…
  (&quot;demand&quot;, 3) =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:1…
  (&quot;ccgt&quot;, 1)   =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:1…
  (&quot;wind&quot;, 1)   =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:1…
  (&quot;ens&quot;, 1)    =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:1…
  (&quot;demand&quot;, 1) =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:1…</code></pre><p>Now we can compute the model.</p><pre><code class="language-julia hljs">model = create_model(graph, representative_periods, constraints_partitions)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">A JuMP Model
Minimization problem with:
Variables: 364
Objective function type: JuMP.AffExpr
`JuMP.AffExpr`-in-`MathOptInterface.EqualTo{Float64}`: 72 constraints
`JuMP.AffExpr`-in-`MathOptInterface.LessThan{Float64}`: 720 constraints
`JuMP.VariableRef`-in-`MathOptInterface.GreaterThan{Float64}`: 364 constraints
`JuMP.VariableRef`-in-`MathOptInterface.LessThan{Float64}`: 1 constraint
`JuMP.VariableRef`-in-`MathOptInterface.Integer`: 4 constraints
Model mode: AUTOMATIC
CachingOptimizer state: EMPTY_OPTIMIZER
Solver name: HiGHS
Names registered in the model: assets_investment, assets_profile_times_capacity, consumer_balance, conversion_balance, energy_limit, flow, flow_max_capacity, flows_investment, hub_balance, incoming_flow, incoming_flow_w_efficiency, lower_bound_transport_flow, outgoing_flow, outgoing_flow_w_efficiency, overall_input_flows, overall_output_flows, storage_balance, storage_inflows, storage_level, transport_flow_lower_bound, transport_flow_upper_bound, upper_bound_asset, upper_bound_for_storage_level, upper_bound_transport_flow</code></pre><p>Finally, we can compute the solution.</p><pre><code class="language-julia hljs">solution = solve_model(model)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(objective_value = 269238.4382415647, assets_investment = 1-dimensional DenseAxisArray{Float64,1,...} with index sets:
    Dimension 1, [&quot;ocgt&quot;, &quot;ccgt&quot;, &quot;wind&quot;, &quot;solar&quot;]
And data, a 4-element Vector{Float64}:
  0.0
  2.0
 35.0
 45.0, flow =   [(&quot;ccgt&quot;, &quot;demand&quot;), 1, 17:17 ]  =  525.5
  [(&quot;ccgt&quot;, &quot;demand&quot;), 1, 1:1   ]  =  757.5
  [(&quot;ccgt&quot;, &quot;demand&quot;), 1, 2:2   ]  =  677.5
  [(&quot;ccgt&quot;, &quot;demand&quot;), 1, 5:5   ]  =  583.0
  [(&quot;ccgt&quot;, &quot;demand&quot;), 2, 7:7   ]  =  0.0
  [(&quot;ccgt&quot;, &quot;demand&quot;), 3, 18:18 ]  =  0.0
  [(&quot;ens&quot;, &quot;demand&quot;), 2, 5:5    ]  =  0.0
  [(&quot;ens&quot;, &quot;demand&quot;), 3, 8:8    ]  =  0.0
                                   ⋮
  [(&quot;ocgt&quot;, &quot;demand&quot;), 1, 23:23 ]  =  -2.27374e-13
  [(&quot;ocgt&quot;, &quot;demand&quot;), 1, 3:3   ]  =  -9.80944e-14
  [(&quot;ocgt&quot;, &quot;demand&quot;), 3, 19:19 ]  =  0.0
  [(&quot;solar&quot;, &quot;demand&quot;), 1, 6:6  ]  =  9.0
  [(&quot;solar&quot;, &quot;demand&quot;), 1, 9:9  ]  =  225.0
  [(&quot;solar&quot;, &quot;demand&quot;), 3, 22:22]  =  0.0
  [(&quot;wind&quot;, &quot;demand&quot;), 3, 12:12 ]  =  793.5, flows_investment = 1-dimensional DenseAxisArray{Float64,1,...} with index sets:
    Dimension 1, Tuple{String, String}[]
And data, a 0-element Vector{Float64}, storage_level = JuMP.Containers.SparseAxisArray{Any, 3, Tuple{Any, Any, Any}} with 0 entries)</code></pre><p>This <code>solution</code> structure is exactly the same as the one returned when using an <code>EnergyProblem</code>.</p><h2 id="graph-tutorial"><a class="docs-heading-anchor" href="#graph-tutorial">Using the graph structure</a><a id="graph-tutorial-1"></a><a class="docs-heading-anchor-permalink" href="#graph-tutorial" title="Permalink"></a></h2><p>Read about the graph structure in the <a href="../how-to-use/#Graph">Graph</a> section first.</p><p>We will use the <code>graph</code> created above for the &quot;Tiny&quot; dataset.</p><p>The first thing that we can do is access all assets. They are the labels of the graph and can be access via the MetaGraphsNext API:</p><pre><code class="language-julia hljs">using MetaGraphsNext
# Accessing assets
labels(graph)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Base.Generator{Base.OneTo{Int64}, MetaGraphsNext.var&quot;#20#21&quot;{MetaGraphsNext.MetaGraph{Int64, Graphs.SimpleGraphs.SimpleDiGraph{Int64}, String, GraphAssetData, GraphFlowData, Nothing, Nothing, Nothing}}}(MetaGraphsNext.var&quot;#20#21&quot;{MetaGraphsNext.MetaGraph{Int64, Graphs.SimpleGraphs.SimpleDiGraph{Int64}, String, GraphAssetData, GraphFlowData, Nothing, Nothing, Nothing}}(Meta graph based on a Graphs.SimpleGraphs.SimpleDiGraph{Int64} with vertex labels of type String, vertex metadata of type GraphAssetData, edge metadata of type GraphFlowData, graph metadata given by nothing, and default weight nothing), Base.OneTo(6))</code></pre><p>Notice that the result is a generator, so if we want the actual results, we have to collect it:</p><pre><code class="language-julia hljs">labels(graph) |&gt; collect</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6-element Vector{String}:
 &quot;ocgt&quot;
 &quot;ccgt&quot;
 &quot;wind&quot;
 &quot;solar&quot;
 &quot;ens&quot;
 &quot;demand&quot;</code></pre><p>To access the asset data, we can index the graph with an asset label:</p><pre><code class="language-julia hljs">graph[&quot;ocgt&quot;]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">GraphAssetData(&quot;producer&quot;, true, 25.0, missing, 100.0, 0.0, 0.0, 0.0, 0.0, 0.0, Dict{Int64, Vector{Float64}}(), Dict{Int64, Vector{UnitRange{Int64}}}(2 =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:15, 16:16, 17:17, 18:18, 19:19, 20:20, 21:21, 22:22, 23:23, 24:24], 3 =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:15, 16:16, 17:17, 18:18, 19:19, 20:20, 21:21, 22:22, 23:23, 24:24], 1 =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:15, 16:16, 17:17, 18:18, 19:19, 20:20, 21:21, 22:22, 23:23, 24:24]), -1, Dict{Tuple{Int64, UnitRange{Int64}}, Float64}())</code></pre><p>This is a Julia struct, or composite type, named <a href="../how-to-use/#GraphAssetData">GraphAssetData</a>. We can access its fields with <code>.</code>:</p><pre><code class="language-julia hljs">graph[&quot;ocgt&quot;].type</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;producer&quot;</code></pre><p>Since <code>labels</code> returns a generator, we can iterate over its contents without collecting it into a vector.</p><pre><code class="language-julia hljs">for a in labels(graph)
    println(&quot;Asset $a has type $(graph[a].type)&quot;)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Asset ocgt has type producer
Asset ccgt has type producer
Asset wind has type producer
Asset solar has type producer
Asset ens has type producer
Asset demand has type consumer</code></pre><p>To get all flows we can use <code>edge_labels</code>:</p><pre><code class="language-julia hljs">edge_labels(graph) |&gt; collect</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5-element Vector{Tuple{String, String}}:
 (&quot;ocgt&quot;, &quot;demand&quot;)
 (&quot;ccgt&quot;, &quot;demand&quot;)
 (&quot;wind&quot;, &quot;demand&quot;)
 (&quot;solar&quot;, &quot;demand&quot;)
 (&quot;ens&quot;, &quot;demand&quot;)</code></pre><p>To access the flow data, we index with <code>graph[u, v]</code>:</p><pre><code class="language-julia hljs">graph[&quot;ocgt&quot;, &quot;demand&quot;]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">GraphFlowData(&quot;electricity&quot;, true, false, false, 0.07, 0.0, missing, 0.0, 0.0, 0.0, 0.0, 0.0, Dict{Int64, Vector{Float64}}(), Dict{Int64, Vector{UnitRange{Int64}}}(2 =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:15, 16:16, 17:17, 18:18, 19:19, 20:20, 21:21, 22:22, 23:23, 24:24], 3 =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:15, 16:16, 17:17, 18:18, 19:19, 20:20, 21:21, 22:22, 23:23, 24:24], 1 =&gt; [1:1, 2:2, 3:3, 4:4, 5:5, 6:6, 7:7, 8:8, 9:9, 10:10  …  15:15, 16:16, 17:17, 18:18, 19:19, 20:20, 21:21, 22:22, 23:23, 24:24]), Dict{Tuple{Int64, UnitRange{Int64}}, Float64}(), -1)</code></pre><p>The type of the flow struct is <a href="../how-to-use/#GraphFlowData">GraphFlowData</a>.</p><p>We can easily find all assets <code>v</code> for which a flow <code>(a, v)</code> exists:</p><pre><code class="language-julia hljs">inneighbor_labels(graph, &quot;demand&quot;) |&gt; collect</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">5-element Vector{String}:
 &quot;ocgt&quot;
 &quot;ccgt&quot;
 &quot;wind&quot;
 &quot;solar&quot;
 &quot;ens&quot;</code></pre><p>Similarly, all assets <code>u</code> for which a flow <code>(u, a)</code> exists:</p><pre><code class="language-julia hljs">outneighbor_labels(graph, &quot;ocgt&quot;) |&gt; collect</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1-element Vector{String}:
 &quot;demand&quot;</code></pre><h2 id="solution-tutorial"><a class="docs-heading-anchor" href="#solution-tutorial">Manipulating the solution</a><a id="solution-tutorial-1"></a><a class="docs-heading-anchor-permalink" href="#solution-tutorial" title="Permalink"></a></h2><p>First, see the description of the <a href="../how-to-use/#Solution">solution</a> object.</p><p>Let&#39;s consider the larger dataset &quot;Norse&quot; in this section. And let&#39;s talk about two ways to access the solution.</p><h3 id="The-solution-returned-by-solve_model"><a class="docs-heading-anchor" href="#The-solution-returned-by-solve_model">The solution returned by solve_model</a><a id="The-solution-returned-by-solve_model-1"></a><a class="docs-heading-anchor-permalink" href="#The-solution-returned-by-solve_model" title="Permalink"></a></h3><p>The solution, as shown before, can be obtained when calling <a href="../reference/#TulipaEnergyModel.solve_model-Tuple{JuMP.Model}"><code>solve_model</code></a> or <a href="../reference/#TulipaEnergyModel.solve_model!-Tuple{TulipaEnergyModel.EnergyProblem}"><code>solve_model!</code></a>.</p><pre><code class="language-julia hljs">using TulipaEnergyModel

# input_dir should be the path to Norse
energy_problem = create_energy_problem_from_csv_folder(input_dir)
create_model!(energy_problem)
solution = solve_model!(energy_problem)</code></pre><p>To create a traditional array in the order given by the investable assets, one can run</p><pre><code class="language-julia hljs">using MetaGraphsNext

graph = energy_problem.graph
[solution.assets_investment[a] for a in labels(graph) if graph[a].investable]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">12-element Vector{Float64}:
   718.0
   500.0
    83.0
 19895.0
     0.0
     0.0
    92.0
    29.0
     0.0
    68.0
    32.0
     0.0</code></pre><p>To create a traditional array in the order given by the investable flows, one can run</p><pre><code class="language-julia hljs">[solution.flows_investment[(u, v)] for (u, v) in edge_labels(graph) if graph[u, v].investable]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3-element Vector{Float64}:
 9.0
 3.0
 2.0</code></pre><p>To create a vector with all values of <code>flow</code> for a given <code>(u, v)</code> and <code>rp</code>, one can run</p><pre><code class="language-julia hljs">(u, v) = first(edge_labels(graph))
rp = 1
[solution.flow[(u, v), rp, B] for B in graph[u, v].partitions[rp]]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">168-element Vector{Float64}:
  0.0
  0.0
  0.0
  0.0
  0.0
  0.0
  0.0
  0.0
  0.0
  0.0
  ⋮
  0.0
  0.0
  0.0
  0.0
  0.0
  0.0
  0.0
 -0.0
  0.0</code></pre><p>To create a vector with the all values of <code>storage_level</code> for a given <code>a</code> and <code>rp</code>, one can run</p><pre><code class="language-julia hljs">a = first(labels(graph))
rp = 1
cons_parts = energy_problem.constraints_partitions
[solution.storage_level[a, rp, B] for B in cons_parts[(a, rp)]]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">168-element Vector{Float64}:
     0.0
     0.0
     0.0
     0.0
     0.0
     0.0
     0.0
     0.0
  5709.499999999997
 12530.499999999996
     ⋮
     0.0
     0.0
     0.0
     0.0
     0.0
     0.0
     0.0
     0.0
     0.0</code></pre><h3 id="The-solution-inside-the-graph"><a class="docs-heading-anchor" href="#The-solution-inside-the-graph">The solution inside the graph</a><a id="The-solution-inside-the-graph-1"></a><a class="docs-heading-anchor-permalink" href="#The-solution-inside-the-graph" title="Permalink"></a></h3><p>In addition to the solution object, the solution is also stored by the individual assets and flows when <a href="../reference/#TulipaEnergyModel.solve_model!-Tuple{TulipaEnergyModel.EnergyProblem}"><code>solve_model!</code></a> is called - i.e., when using a <a href="../how-to-use/#EnergyProblem">EnergyProblem</a> object.</p><p>They can be accessed like any other value from <a href="../how-to-use/#GraphAssetData">GraphAssetData</a> or <a href="../how-to-use/#GraphFlowData">GraphFlowData</a>, which means that we recreate the values from the previous section in a new way:</p><pre><code class="language-julia hljs">[energy_problem.graph[a].investment for a in labels(graph) if graph[a].investable]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">12-element Vector{Int64}:
   718
   500
    83
 19895
     0
     0
    92
    29
     0
    68
    32
     0</code></pre><pre><code class="language-julia hljs">[energy_problem.graph[u, v].investment for (u, v) in edge_labels(graph) if graph[u, v].investable]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">3-element Vector{Int64}:
 9
 3
 2</code></pre><pre><code class="language-julia hljs">(u, v) = first(edge_labels(graph))
rp = 1
[energy_problem.graph[u, v].flow[(rp, B)] for B in graph[u, v].partitions[rp]]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">168-element Vector{Float64}:
  0.0
  0.0
  0.0
  0.0
  0.0
  0.0
  0.0
  0.0
  0.0
  0.0
  ⋮
  0.0
  0.0
  0.0
  0.0
  0.0
  0.0
  0.0
 -0.0
  0.0</code></pre><p>To create a vector with the all values of <code>storage_level</code> for a given <code>a</code> and <code>rp</code>, one can run</p><pre><code class="language-julia hljs">a = first(labels(graph))
rp = 1
cons_parts = energy_problem.constraints_partitions
[energy_problem.graph[a].storage_level[(rp, B)] for B in cons_parts[(a, rp)]]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">168-element Vector{Float64}:
     0.0
     0.0
     0.0
     0.0
     0.0
     0.0
     0.0
     0.0
  5709.499999999997
 12530.499999999996
     ⋮
     0.0
     0.0
     0.0
     0.0
     0.0
     0.0
     0.0
     0.0
     0.0</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../api/">« API</a><a class="docs-footer-nextpage" href="../reference/">Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.2.1 on <span class="colophon-date" title="Tuesday 5 December 2023 07:39">Tuesday 5 December 2023</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
