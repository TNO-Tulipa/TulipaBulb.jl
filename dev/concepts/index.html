<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Concepts · TulipaEnergyModel.jl</title><meta name="title" content="Concepts · TulipaEnergyModel.jl"/><meta property="og:title" content="Concepts · TulipaEnergyModel.jl"/><meta property="twitter:title" content="Concepts · TulipaEnergyModel.jl"/><meta name="description" content="Documentation for TulipaEnergyModel.jl."/><meta property="og:description" content="Documentation for TulipaEnergyModel.jl."/><meta property="twitter:description" content="Documentation for TulipaEnergyModel.jl."/><meta property="og:url" content="https://TulipaEnergy.github.io/TulipaEnergyModel.jl/concepts/"/><meta property="twitter:url" content="https://TulipaEnergy.github.io/TulipaEnergyModel.jl/concepts/"/><link rel="canonical" href="https://TulipaEnergy.github.io/TulipaEnergyModel.jl/concepts/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/style.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="TulipaEnergyModel.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">TulipaEnergyModel.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../how-to-use/">How to Use</a></li><li><a class="tocitem" href="../tutorials/">Tutorials</a></li><li class="is-active"><a class="tocitem" href>Concepts</a><ul class="internal"><li><a class="tocitem" href="#concepts-summary"><span>Summary</span></a></li><li><a class="tocitem" href="#flex-asset-connection"><span>Flexible Connection of Energy Assets</span></a></li><li><a class="tocitem" href="#flex-time-res"><span>Flexible Time Resolution</span></a></li><li><a class="tocitem" href="#storage-modeling"><span>Storage Modeling</span></a></li></ul></li><li><a class="tocitem" href="../formulation/">Mathematical Formulation</a></li><li><a class="tocitem" href="../api/">API</a></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Concepts</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Concepts</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/TulipaEnergy/TulipaEnergyModel.jl.git" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="concepts"><a class="docs-heading-anchor" href="#concepts">Concepts</a><a id="concepts-1"></a><a class="docs-heading-anchor-permalink" href="#concepts" title="Permalink"></a></h1><ul><li><a href="#concepts">Concepts</a></li><li class="no-marker"><ul><li><a href="#concepts-summary">Summary</a></li><li><a href="#flex-asset-connection">Flexible Connection of Energy Assets</a></li><li><a href="#flex-time-res">Flexible Time Resolution</a></li><li class="no-marker"><ul><li><a href="#Energy-Balance-Constraints">Energy Balance Constraints</a></li><li><a href="#Capacity-Constraints">Capacity Constraints</a></li><li><a href="#Storage-Level-limits">Storage Level limits</a></li><li><a href="#comparison">Comparison of Different Modeling Approaches</a></li></ul></li><li><a href="#storage-modeling">Storage Modeling</a></li><li class="no-marker"><ul><li><a href="#Example-to-Model-Seasonal-and-Non-seasonal-Storage">Example to Model Seasonal and Non-seasonal Storage</a></li></ul></li></ul></li></ul><h2 id="concepts-summary"><a class="docs-heading-anchor" href="#concepts-summary">Summary</a><a id="concepts-summary-1"></a><a class="docs-heading-anchor-permalink" href="#concepts-summary" title="Permalink"></a></h2><p><em>TulipaEnergyModel.jl</em> incorporates two fundamental concepts that serve as the foundation of the optimization model:</p><ul><li><strong>Energy Assets</strong>: representation of a physical asset that can produce, consume, store, balance, or convert energy. Some examples of what these assets can represent are:<ul><li>Producer: e.g., wind turbine, solar panel</li><li>Consumer: e.g., electricity demand, heat demand</li><li>Storage: e.g., battery, pumped-hydro storage</li><li>Balancing Hub: e.g., an electricity network that serves as a connection among other energy assets</li><li>Conversion: e.g., power plants, electrolyzers</li></ul></li><li><strong>Flows</strong>: representation of the connections among assets, e.g., pipelines, transmission lines, or simply the energy production that goes from one asset to another.</li></ul><p>In a nutshell, the model guarantees a balance of energy for the various types of assets while considering the flow limits. It considers a set of <a href="../how-to-use/#representative-periods">representative periods</a> (e.g., days or weeks) for a given <a href="../how-to-use/#timeframe">timeframe</a> (e.g., a year) the user wants to analyze. Therefore, the model has two types of temporal (time) constraints to consider the different chronology characteristics of the assets:</p><ul><li><strong>Intra-temporal Constraints</strong>: These constraints limit the asset or flow within a representative period. The intra-temporal constraints help to characterize the short-term operational dynamics of the assets. So far, the model considers balance and flow limitations within the representative period, but future developments will include unit commitment, ramping, and reserve constraints.</li><li><strong>Inter-temporal Constraints</strong>: These constraints combine the information of the representative periods and create limitations between them to recover chronological information across the whole timeframe. The inter-temporal constraints help to characterize the long-term operational dynamics of the assets (e.g., seasonality). So far, the model uses this type of constraint to model seasonal storage. Still, future developments will include, for example, maximum or minimum production/consumption for a year (or any timeframe).</li></ul><p>The <a href="../formulation/#formulation"><code>mathematical formulation</code></a> shows an overview of these constraints and the variables in the model.</p><p>Another essential concept in the model is the <a href="#flex-time-res">flexible time resolution</a>, which allows for each asset to be considered in a single timestep (e.g., 1, 2, 3...) or in a range of timesteps (e.g., 1:3, meaning that the asset&#39;s variable represents the value of timesteps 1, 2, and 3). This concept allows the modeling of different dynamics depending on the asset; for instance, electricity assets can be modeled hourly, whereas hydrogen assets can be modeled in a 6-hour resolution (avoiding creating unnecessary constraints and variables).</p><p>The following sections explain these concepts in more detail.</p><h2 id="flex-asset-connection"><a class="docs-heading-anchor" href="#flex-asset-connection">Flexible Connection of Energy Assets</a><a id="flex-asset-connection-1"></a><a class="docs-heading-anchor-permalink" href="#flex-asset-connection" title="Permalink"></a></h2><p>In energy system modeling, it is becoming common to have hybrid assets like <code>storage + renewable</code> (e.g., battery + solar), <code>electrolyzer + renewable</code> (e.g., electrolyzer + wind), or <code>renewable + hydro</code> (e.g., solar + hydro) that are located at the same site and share a common connection point to the grid. The standard method of modeling these assets requires extra variables and constraints for them to function correctly. For example, flows from the grid are not allowed, as they either avoid charging from the grid or require green hydrogen production. Therefore, hybrid connections typically require an additional node to regulate this connection with the grid.</p><p>The representation of the energy system in <em>TulipaEnergyModel.jl</em> is based on <a href="https://en.wikipedia.org/wiki/Graph_theory">Graph Theory</a>, which deals with the connection between vertices by edges. This representation provides a more flexible framework to model energy <em>assets</em> in the system as <em>vertices</em> and <em>flows</em> between energy assets as <em>edges</em>. By connecting assets directly to each other (i.e., without having a node in between), we reduce the number of variables and constraints needed to represent hybrid configurations, thus reducing the model size.</p><p>Consider the following example to demonstrate the benefits of using a graph theory approach. In the classic connection approach, the nodes play a crucial role in modeling. For instance, every asset must be connected to a node with balance constraints. When a storage asset and a renewable asset are in a hybrid connection like the one described before, a connection point is needed to connect the hybrid configuration to the rest of the system. Therefore, to consider the hybrid configuration of a storage asset and a renewable asset, we must introduce a node (i.e., a connection point) between these assets and the external power grid (i.e., a balance point), as shown in the following figure:</p><p><img src="../figs/flexible-connection-1.png" alt="Classic connection"/></p><p>In this system, the <code>phs</code> storage asset charges and discharges from the <code>connection point</code>, while the <code>wind</code> turbine produces power that goes directly to the <code>connection point</code>. This <code>connection point</code> is connected to the external power grid through a transmission line that leads to a <code>balance</code> hub that connects to other assets. Essentially, the <code>connection point</code> acts as a balancing hub point for the assets in this hybrid configuration. Furthermore, these hybrid configurations impose an extra constraint to avoid storage charges from the power grid.</p><p>Let&#39;s consider the modeling approach in <em>TulipaEnergyModel.jl</em>. As nodes are no longer needed to connect assets, we can connect them directly to each other, as shown in the figure below:</p><p><img src="../figs/flexible-connection-2.png" alt="Flexible connection"/></p><p>By implementing this approach, we can reduce the number of variables and constraints involved. For example, the balance constraint in the intermediate node and the extra constraint to avoid the storage charging from the power grid are no longer needed. Additionally, we can eliminate the variable determining the flow between the intermediate node and the power grid, because the flow from <code>phs</code> to <code>balance</code> can directly link to the external grid. The section <a href="#comparison"><code>comparison of different modeling approaches</code></a> shows the quantification of these reductions.</p><p>This example of a <code>phs</code> and a <code>wind</code> asset is useful for illustrating the advantages of this modeling approach and will be reused in the following sections. However, please keep in mind that there are other applications of hybrid configurations, such as battery-solar, hydro-solar, and electrolyzer-wind.</p><h2 id="flex-time-res"><a class="docs-heading-anchor" href="#flex-time-res">Flexible Time Resolution</a><a id="flex-time-res-1"></a><a class="docs-heading-anchor-permalink" href="#flex-time-res" title="Permalink"></a></h2><p>One of the core features of <em>TulipaEnergyModel.jl</em> is that it can handle different time resolutions on the assets and the flows. Typically, the time resolution in an energy model is hourly, like in the following figure where we have a 6-hour energy system:</p><p><img src="../figs/variable-time-resolution-1.png" alt="Hourly Time Resolution"/></p><p>Therefore, for this simple example, we can determine the number of constraints and variables in the optimization problem:</p><ul><li><p><em>Number of variables</em>: 42 since we have six connections among assets (i.e., 6 flows x 6 hours = 36 variables) and one storage asset (i.e., 1 storage level x 6 h = 6 variables)</p></li><li><p><em>Number of constraints</em>: 72, which are:</p><ul><li>24 from the maximum output limit of the assets that produce, convert, or discharge energy (i.e., <code>H2</code>, <code>wind</code>, <code>ccgt</code>, and <code>phs</code>) for each hour (i.e., 4 assets x 6 h = 24 constraints)</li><li>6 from the maximum input limit of the storage or charging limit for the <code>phs</code></li><li>6 from the maximum storage level limit for the <code>phs</code></li><li>12 from the import and export limits for the transmission line between the <code>balance</code> hub and the <code>demand</code></li><li>24 from the energy balance on the consumer, hub, conversion, and storage assets (i.e., <code>demand</code>, <code>balance</code>, <code>ccgt</code>, and <code>phs</code>) for each hour (i.e., 4 assets x 6 h = 24 constraints)</li></ul></li></ul><p>Depending on the input data and the level of detail you want to model, hourly resolution in all the variables might not be necessary. <em>TulipaEnergyModel.jl</em> can have different time resolutions for each asset and flow to simplify the optimization problem and approximate hourly representation. This feature is useful for large-scale energy systems that involve multiple sectors, as detailed granularity is not always necessary due to the unique temporal dynamics of each sector. For instance, we can use hourly resolution for the electricity sector and six-hour resolution for the hydrogen sector. We can couple multiple sectors, each with its own temporal resolution.</p><p>Let&#39;s explore the flexibility of time resolution with a few examples.</p><p>The following table shows the user input data for the definition of asset time resolution. Please note that the values presented in this example are just for illustrative purposes and do not represent a realistic case.</p><div><div style = "float: left;"><span>2×4 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">asset</th><th style = "text-align: left;">rep_period</th><th style = "text-align: left;">specification</th><th style = "text-align: left;">partition</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "InlineStrings.String7" style = "text-align: left;">String7</th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "InlineStrings.String7" style = "text-align: left;">String7</th><th title = "Int64" style = "text-align: left;">Int64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">H2</td><td style = "text-align: right;">1</td><td style = "text-align: left;">uniform</td><td style = "text-align: right;">6</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">phs</td><td style = "text-align: right;">1</td><td style = "text-align: left;">uniform</td><td style = "text-align: right;">6</td></tr></tbody></table></div><p>The table shows that the <code>H2</code> producer and the <code>phs</code> storage have a <code>uniform</code> definition of 6 hours. This definition means we want to represent the <code>H2</code> production profile and the storage level of the <code>phs</code> every six hours.</p><p>The same time resolution can be specified for the flows, for example (again, the values are for illustrative purposes and do not represent a realistic case):</p><div><div style = "float: left;"><span>5×5 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">from_asset</th><th style = "text-align: left;">to_asset</th><th style = "text-align: left;">rep_period</th><th style = "text-align: left;">specification</th><th style = "text-align: left;">partition</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "InlineStrings.String7" style = "text-align: left;">String7</th><th title = "InlineStrings.String7" style = "text-align: left;">String7</th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "InlineStrings.String7" style = "text-align: left;">String7</th><th title = "InlineStrings.String7" style = "text-align: left;">String7</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">H2</td><td style = "text-align: left;">ccgt</td><td style = "text-align: right;">1</td><td style = "text-align: left;">uniform</td><td style = "text-align: left;">6</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">wind</td><td style = "text-align: left;">balance</td><td style = "text-align: right;">1</td><td style = "text-align: left;">math</td><td style = "text-align: left;">1x2+1x4</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">wind</td><td style = "text-align: left;">phs</td><td style = "text-align: right;">1</td><td style = "text-align: left;">uniform</td><td style = "text-align: left;">3</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">phs</td><td style = "text-align: left;">balance</td><td style = "text-align: right;">1</td><td style = "text-align: left;">math</td><td style = "text-align: left;">1x4+1x2</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">balance</td><td style = "text-align: left;">demand</td><td style = "text-align: right;">1</td><td style = "text-align: left;">uniform</td><td style = "text-align: left;">3</td></tr></tbody></table></div><p>The table shows a <code>uniform</code> definition for the flow from the hydrogen producer (<code>H2</code>) to the conversion asset (<code>ccgt</code>) of 6 hours, from the wind producer (<code>wind</code>) to the storage (<code>phs</code>) of 3 hours, and from the balance hub (<code>balance</code>) to the consumer (<code>demand</code>) of 3 hours, too. In addition, the flow from the wind producer (<code>wind</code>) to the balance hub (<code>balance</code>) is defined using the <code>math</code> specification of <code>1x2+1x4</code>, meaning that there are two time blocks, one of two hours (i.e., <code>1:2</code>) and another of four hours (i.e., <code>3:6</code>). Finally, the flow from the storage (<code>phs</code>) to the balance hub (<code>balance</code>) is defined using the <code>math</code> specification of <code>1x4+1x2</code>, meaning that there are two time blocks, one of four hours (i.e., <code>1:4</code>) and another of two hours (i.e., <code>5:6</code>).</p><p>The following figure illustrates these definitions on the example system.</p><p><img src="../figs/variable-time-resolution-2.png" alt="Variable Time Resolution"/></p><p>So, let&#39;s recap:</p><ul><li>The hydrogen producer (<code>H2</code>) is in a 6-hour resolution represented by the range <code>1:6</code>, meaning that the balance of the hydrogen produced is for every 6 hours.</li><li>The flow from the hydrogen producer to the ccgt power plant (<code>H2,ccgt</code>) is also in a 6-hour resolution <code>1:6</code>.</li><li>The flow from the ccgt power plant to the balance hub (<code>ccgt, balance</code>) has hourly resolution <code>[1,2,3,4,5,6]</code>.</li><li>The <code>ccgt</code> is a conversion plant that takes hydrogen to produce electricity. Since both sectors have different time resolutions, the energy balance in the conversion asset is defined in the lowest resolution connecting to the asset. In this case, the energy balance in the <code>ccgt</code> is defined every 6 hours, i.e., in the range <code>1:6</code>.</li><li>The <code>wind</code> producer has an hourly profile of electricity production, so the resolution of the asset is hourly.</li><li>The <code>wind</code> producer output has two connections, one to the <code>balance</code> hub and the other to the pumped-hydro storage (<code>phs</code>) with different resolutions:<ul><li>The flow from the wind producer to the phs storage (<code>wind, phs</code>) has a uniform resolution of two blocks from hours 1 to 3 (i.e., <code>1:3</code>) and from hours 4 to 6 (i.e., <code>4:6</code>).</li><li>The flow from the wind producer to the balance hub (<code>wind, balance</code>) has a variable resolution of two blocks, too, but from hours 1 to 2 (i.e., <code>1:2</code>) and from hours 3 to 6 (i.e., <code>3:6</code>).</li></ul></li><li>The <code>phs</code> is in a 6-hour resolution represented by the range <code>1:6</code>, meaning the storage balance is determined every 6 hours.</li><li>The flow from the phs to the balance (<code>phs, balance</code>) represents the discharge of the <code>phs</code>. This flow has a variable resolution of two blocks from hours 1 to 4 (i.e., <code>1:4</code>) and from hours 5 to 6 (i.e., <code>5:6</code>), which differs from the one defined for the charging flow from the <code>wind</code> asset.</li><li>The <code>demand</code> consumption has hourly input data with one connection to the <code>balance</code> hub:<ul><li>The flow from the balance hub to the demand (<code>balance, demand</code>) has a uniform resolution of 3 hours; therefore, it has two blocks, one from hours 1 to 3 (i.e., <code>1:3</code>) and the other from hours 4 to 6 (i.e., <code>4:6</code>).</li></ul></li><li>The <code>balance</code> hub integrates all the different assets with their different resolutions. The lowest resolution of all connections determines the balance equation for this asset. Therefore, the resulting resolution is into two blocks, one from hours 1 to 4 (i.e., <code>1:4</code>) and the other from hours 5 to 6 (i.e., <code>5:6</code>).</li></ul><blockquote><p><strong>Note:</strong> This example demonstrates that different time resolutions can be assigned to each asset and flow in the model. Additionally, the resolutions do not need to be uniform and can vary throughout the horizon.</p></blockquote><p>The complete input data for this example can be found <a href="https://github.com/TulipaEnergy/TulipaEnergyModel.jl/tree/main/test/inputs/Variable%20Resolution">here</a>.</p><p>Due to the flexible resolution, we must explicitly state how the constraints are constructed. For each constraint, three things need to be considered:</p><ul><li>Whether it is type <em>power</em> or type <em>energy</em>.<ul><li>type <em>power</em>: highest resolution</li><li>type <em>energy</em>: lowest resolution (multiplied by durations)</li></ul></li><li>How the resolution is determined (regardless of whether it is highest or lowest): the incoming flows, the outgoing flows, or a combination of both.</li><li>How the related parameters are treated. We use two methods of aggregation, <em>sum</em> or <em>mean</em>.</li></ul><p>Below is the table outlining the details for each type of constraint. Note <em>min</em> means highest resolution, and <em>max</em> means lowest resolution.</p><table><tr><th style="text-align: right">Name</th><th style="text-align: right">Variables involved</th><th style="text-align: right">Parameters involved</th><th style="text-align: right">Constraint type</th><th style="text-align: right">Resolution of the constraints</th><th style="text-align: right">Parameter aggregation</th></tr><tr><td style="text-align: right">Consumer Balance</td><td style="text-align: right">inputs, outputs</td><td style="text-align: right">demand</td><td style="text-align: right">power</td><td style="text-align: right">min(incoming flows, outgoing flows)</td><td style="text-align: right">mean</td></tr><tr><td style="text-align: right">Storage Balance</td><td style="text-align: right">inputs, outputs, storage level</td><td style="text-align: right">inflows</td><td style="text-align: right">energy</td><td style="text-align: right">max(asset, min(incoming flows, outgoing flows))</td><td style="text-align: right">sum</td></tr><tr><td style="text-align: right">Hub Balance</td><td style="text-align: right">inputs, outputs</td><td style="text-align: right">-</td><td style="text-align: right">power</td><td style="text-align: right">min(incoming flows, outgoing flows)</td><td style="text-align: right">-</td></tr><tr><td style="text-align: right">Conversion Balance</td><td style="text-align: right">inputs, outputs</td><td style="text-align: right">-</td><td style="text-align: right">energy</td><td style="text-align: right">max(incoming flows, outgoing flows)</td><td style="text-align: right">-</td></tr><tr><td style="text-align: right">Producers Capacity Constraints</td><td style="text-align: right">outputs</td><td style="text-align: right">production</td><td style="text-align: right">power</td><td style="text-align: right">min(outgoing flows)</td><td style="text-align: right">mean</td></tr><tr><td style="text-align: right">Storage Capacity Constraints (outgoing)</td><td style="text-align: right">outputs</td><td style="text-align: right">-</td><td style="text-align: right">power</td><td style="text-align: right">min(outgoing flows)</td><td style="text-align: right">-</td></tr><tr><td style="text-align: right">Conversion Capacity Constraints (outgoing)</td><td style="text-align: right">outputs</td><td style="text-align: right">-</td><td style="text-align: right">power</td><td style="text-align: right">min(outgoing flows)</td><td style="text-align: right">-</td></tr><tr><td style="text-align: right">Conversion Capacity Constraints (incoming)</td><td style="text-align: right">inputs</td><td style="text-align: right">-</td><td style="text-align: right">power</td><td style="text-align: right">min(incoming flows)</td><td style="text-align: right">-</td></tr><tr><td style="text-align: right">Storage Capacity Constraints (incoming)</td><td style="text-align: right">inputs</td><td style="text-align: right">-</td><td style="text-align: right">power</td><td style="text-align: right">min(incoming flows)</td><td style="text-align: right">-</td></tr><tr><td style="text-align: right">Transport Capacity Constraints (upper bounds)</td><td style="text-align: right">flow</td><td style="text-align: right">capacity</td><td style="text-align: right">power</td><td style="text-align: right">if it connects two hubs or demands then max(hub a,hub b), otherwise its own</td><td style="text-align: right">mean</td></tr><tr><td style="text-align: right">Transport Capacity Constraints (lower bounds)</td><td style="text-align: right">flow</td><td style="text-align: right">capacity</td><td style="text-align: right">power</td><td style="text-align: right">if it connects two hubs or demands then max(hub a,hub b), otherwise its own</td><td style="text-align: right">mean</td></tr></table><p>For this basic example, we can describe the balance and capacity constraints in the model. For the sake of simplicity, we consider only the intra-temporal constraints, the representative period index is dropped from the equations, and there are no investment variables in the equations.</p><h3 id="Energy-Balance-Constraints"><a class="docs-heading-anchor" href="#Energy-Balance-Constraints">Energy Balance Constraints</a><a id="Energy-Balance-Constraints-1"></a><a class="docs-heading-anchor-permalink" href="#Energy-Balance-Constraints" title="Permalink"></a></h3><p>In the following sections, we lay out all the balance constraints of this example.</p><h4 id="Storage-Balance"><a class="docs-heading-anchor" href="#Storage-Balance">Storage Balance</a><a id="Storage-Balance-1"></a><a class="docs-heading-anchor-permalink" href="#Storage-Balance" title="Permalink"></a></h4><p>As shown in the table, the resolution of the storage balance is energy, which is calculated by <em>max(asset, min(incoming flows, outgoing flows))</em>. The resolutions of the incoming and outgoing flows of the storage are <code>1:3</code>, <code>4:6</code>, <code>1:4</code>, and <code>5:6</code>, resulting in a minimum resolution of 2. The resolution of the storage is 6. Then, <em>max(asset, min(incoming flows, outgoing flows))</em> becomes <em>max(6, min(3, (4, 2)))</em> which results in 6, and thus this balance is for every 6 hours. The charging and discharging flows are multiplied by their durations to account for the energy in the range <code>1:6</code>.</p><p class="math-container">\[\begin{aligned}
&amp; \text{storage\_balance}_{\text{phs},1:6}: \\
&amp; \qquad v^{\text{intra-storage}}_{\text{phs},1:6} = 3 \cdot p^{\text{eff}}_{(\text{wind},\text{phs})} \cdot v^{\text{flow}}_{(\text{wind},\text{phs}),1:3} + 3 \cdot p^{\text{eff}}_{(\text{wind},\text{phs})} \cdot v^{\text{flow}}_{(\text{wind},\text{phs}),4:6} \\
&amp; \qquad \quad - \frac{4}{p^{\text{eff}}_{(\text{phs},\text{balance})}} \cdot v^{\text{flow}}_{(\text{phs},\text{balance}),1:4} - \frac{2}{p^{\text{eff}}_{(\text{phs},\text{balance})}} \cdot v^{\text{flow}}_{(\text{phs},\text{balance}),5:6} \\
\end{aligned}\]</p><h4 id="Consumer-Balance"><a class="docs-heading-anchor" href="#Consumer-Balance">Consumer Balance</a><a id="Consumer-Balance-1"></a><a class="docs-heading-anchor-permalink" href="#Consumer-Balance" title="Permalink"></a></h4><p>The flows coming from the balancing hub are defined every 3 hours. Therefore, the flows impose the lowest resolution and the demand is balanced every 3 hours. The input demand is aggregated as the mean of the hourly values in the input data. As with the storage balance, the flows are multiplied by their durations.</p><p class="math-container">\[\begin{aligned}
&amp; \text{consumer\_balance}_{\text{demand},1:3}: \\
&amp; \qquad v^{\text{flow}}_{(\text{balance},\text{demand}),1:3} = p^{\text{peak demand}}_{\text{demand}} \cdot \frac{\sum_{b=1}^{3} p^{\text{demand profile}}_{\text{demand},b}}{3} \\
&amp; \text{consumer\_balance}_{\text{demand},4:6}: \\
&amp; \qquad v^{\text{flow}}_{(\text{balance},\text{demand}),4:6} = p^{\text{peak demand}}_{\text{demand}} \cdot \frac{\sum_{b=4}^{6} p^{\text{demand profile}}_{\text{demand},b}}{3} \\
\end{aligned}\]</p><h4 id="Hub-Balance"><a class="docs-heading-anchor" href="#Hub-Balance">Hub Balance</a><a id="Hub-Balance-1"></a><a class="docs-heading-anchor-permalink" href="#Hub-Balance" title="Permalink"></a></h4><p>The hub balance is quite interesting because it integrates several flow resolutions. Remember that we didn&#39;t define any specific time resolution for this asset. Therefore, the highest resolution of all incoming and outgoing flows in the horizon implies that the hub balance must be imposed for all 6 blocks. The balance must account for each flow variable&#39;s duration in each block.</p><p class="math-container">\[\begin{aligned}
&amp; \text{hub\_balance}_{\text{balance},1:1}: \\
&amp; \qquad v^{\text{flow}}_{(\text{balance},\text{demand}),1:3} = v^{\text{flow}}_{(\text{ccgt},\text{balance}), 1:1} + v^{\text{flow}}_{(\text{wind},\text{balance}),1:2} + v^{\text{flow}}_{(\text{phs},\text{balance}),1:4} \\
&amp; \text{hub\_balance}_{\text{balance},2:2}: \\
&amp; \qquad v^{\text{flow}}_{(\text{balance},\text{demand}),1:3} = v^{\text{flow}}_{(\text{ccgt},\text{balance}), 2:2} + v^{\text{flow}}_{(\text{wind},\text{balance}),1:2} + v^{\text{flow}}_{(\text{phs},\text{balance}),1:4} \\
&amp; \text{hub\_balance}_{\text{balance},3:3}: \\
&amp; \qquad v^{\text{flow}}_{(\text{balance},\text{demand}),1:3} = v^{\text{flow}}_{(\text{ccgt},\text{balance}), 3:3} + v^{\text{flow}}_{(\text{wind},\text{balance}),3:6} + v^{\text{flow}}_{(\text{phs},\text{balance}),1:4} \\
&amp; \text{hub\_balance}_{\text{balance},4:4}: \\
&amp; \qquad v^{\text{flow}}_{(\text{balance},\text{demand}),4:6} = v^{\text{flow}}_{(\text{ccgt},\text{balance}), 4:4} + v^{\text{flow}}_{(\text{wind},\text{balance}),3:6} + v^{\text{flow}}_{(\text{phs},\text{balance}),1:4}\\
&amp; \text{hub\_balance}_{\text{balance},5:5}: \\
&amp; \qquad v^{\text{flow}}_{(\text{balance},\text{demand}),4:6} = v^{\text{flow}}_{(\text{ccgt},\text{balance}), 5:5} + v^{\text{flow}}_{(\text{wind},\text{balance}),3:6} + v^{\text{flow}}_{(\text{phs},\text{balance}),5:6} \\
&amp; \text{hub\_balance}_{\text{balance},6:6}: \\
&amp; \qquad v^{\text{flow}}_{(\text{balance},\text{demand}),4:6} = v^{\text{flow}}_{(\text{ccgt},\text{balance}), 6:6} + v^{\text{flow}}_{(\text{wind},\text{balance}),3:6} + v^{\text{flow}}_{(\text{phs},\text{balance}),5:6} \\
\end{aligned}\]</p><h4 id="Conversion-Balance"><a class="docs-heading-anchor" href="#Conversion-Balance">Conversion Balance</a><a id="Conversion-Balance-1"></a><a class="docs-heading-anchor-permalink" href="#Conversion-Balance" title="Permalink"></a></h4><p>The flows connected to the CCGT conversion unit have different resolutions, too. In this case, the hydrogen imposes the lowest resolution; therefore, the energy balance in this asset is also every 6 hours.</p><p class="math-container">\[\begin{aligned}
&amp; \text{conversion\_balance}_{\text{ccgt},1:6}: \\
&amp; \qquad 6 \cdot p^{\text{eff}}_{(\text{H2},\text{ccgt})} \cdot v^{\text{flow}}_{(\text{H2},\text{ccgt}),1:6} = \frac{1}{p^{\text{eff}}_{(\text{ccgt},\text{balance})}} \sum_{b=1}^{6} v^{\text{flow}}_{(\text{ccgt},\text{balance}),b}  \\
\end{aligned}\]</p><h3 id="Capacity-Constraints"><a class="docs-heading-anchor" href="#Capacity-Constraints">Capacity Constraints</a><a id="Capacity-Constraints-1"></a><a class="docs-heading-anchor-permalink" href="#Capacity-Constraints" title="Permalink"></a></h3><p>All capacity constraints are defined in the highest resolution to guarantee that the flows are below the limits of each asset capacity.</p><h4 id="Storage-Capacity-Constraints"><a class="docs-heading-anchor" href="#Storage-Capacity-Constraints">Storage Capacity Constraints</a><a id="Storage-Capacity-Constraints-1"></a><a class="docs-heading-anchor-permalink" href="#Storage-Capacity-Constraints" title="Permalink"></a></h4><p>Since the storage unit only has one input and output, the capacity limit constraints are in the same resolution as the individual flows. Therefore, the constraints for the outputs of the storage (i.e., discharging capacity limit) are:</p><p class="math-container">\[\begin{aligned}
&amp; \text{max\_output\_flows\_limit}_{\text{phs},1:4}: \\
&amp; \qquad v^{\text{flow}}_{(\text{phs},\text{balance}),1:4} \leq p^{\text{init capacity}}_{\text{phs}} \\
&amp; \text{max\_output\_flows\_limit}_{\text{phs},5:6}: \\
&amp; \qquad v^{\text{flow}}_{(\text{phs},\text{balance}),5:6} \leq p^{\text{init capacity}}_{\text{phs}} \\
\end{aligned}\]</p><p>And the constraints for the inputs of the storage (i.e., charging capacity limit) are:</p><p class="math-container">\[\begin{aligned}
&amp; \text{max\_input\_flows\_limit}_{\text{phs},1:3}: \\
&amp; \qquad v^{\text{flow}}_{(\text{wind},\text{phs}),1:3} \leq p^{\text{init capacity}}_{\text{phs}} \\
&amp; \text{max\_input\_flows\_limit}_{\text{phs},4:6}: \\
&amp; \qquad v^{\text{flow}}_{(\text{wind},\text{phs}),4:6} \leq p^{\text{init capacity}}_{\text{phs}} \\
\end{aligned}\]</p><h4 id="Conversion-Capacity-Constraints"><a class="docs-heading-anchor" href="#Conversion-Capacity-Constraints">Conversion Capacity Constraints</a><a id="Conversion-Capacity-Constraints-1"></a><a class="docs-heading-anchor-permalink" href="#Conversion-Capacity-Constraints" title="Permalink"></a></h4><p>Similarly, each outflow is limited to the <code>ccgt</code> capacity for the conversion unit.</p><p class="math-container">\[\begin{aligned}
&amp; \text{max\_output\_flows\_limit}_{\text{ccgt},b}: \\
&amp; \qquad v^{\text{flow}}_{(\text{ccgt},\text{balance}),b} \leq p^{\text{init capacity}}_{\text{ccgt}} \quad \forall b \in [1,6] \\
\end{aligned}\]</p><h4 id="Producer-Capacity-Constraints"><a class="docs-heading-anchor" href="#Producer-Capacity-Constraints">Producer Capacity Constraints</a><a id="Producer-Capacity-Constraints-1"></a><a class="docs-heading-anchor-permalink" href="#Producer-Capacity-Constraints" title="Permalink"></a></h4><p>The <code>wind</code> producer asset is interesting because the output flows are in different resolutions, i.e., <code>1:2</code>, <code>3:6</code>, <code>1:3</code>, and <code>4:6</code>. The highest resolution is <code>1:2</code>, <code>3</code>, and <code>4:6</code>. Therefore, the constraints are as follows:</p><p class="math-container">\[\begin{aligned}
&amp; \text{max\_output\_flows\_limit}_{\text{wind},1:2}: \\
&amp; \qquad v^{\text{flow}}_{(\text{wind},\text{balance}),1:2} + v^{\text{flow}}_{(\text{wind},\text{phs}),1:3} \leq \frac{p^{\text{init capacity}}_{\text{wind}}}{2} \cdot \sum_{b=1}^{2} p^{\text{availability profile}}_{\text{wind},b} \\
&amp; \text{max\_output\_flows\_limit}_{\text{wind},3}: \\
&amp; \qquad v^{\text{flow}}_{(\text{wind},\text{balance}),3:6} + v^{\text{flow}}_{(\text{wind},\text{phs}),1:3} \leq p^{\text{init capacity}}_{\text{wind}} \cdot p^{\text{availability profile}}_{\text{wind},3} \\
&amp; \text{max\_output\_flows\_limit}_{\text{wind},4:6}: \\
&amp; \qquad v^{\text{flow}}_{(\text{wind},\text{balance}),3:6} + v^{\text{flow}}_{(\text{wind},\text{phs}),4:6} \leq \frac{p^{\text{init capacity}}_{\text{wind}}}{2} \cdot \sum_{b=5}^{6} p^{\text{availability profile}}_{\text{wind},b} \\
\end{aligned}\]</p><p>Since the flow variables <span>$v^{\text{flow}}_{(\text{wind}, \text{balance}),1:2}$</span> and <span>$v^{\text{flow}}_{(\text{wind}, \text{balance}),1:3}$</span> represent power, the first constraint sets the upper bound of the power for both timestep 1 and 2, by assuming an average capacity across these two timesteps. The same applies to the other two constraints.</p><p>The hydrogen (H2) producer capacity limit is straightforward, since both the asset and the flow definitions are in the same time resolution:</p><p class="math-container">\[\begin{aligned}
&amp; \text{max\_output\_flows\_limit}_{\text{H2},1:6}: \\
&amp; \qquad v^{\text{flow}}_{(\text{H2},\text{ccgt}),1:6} \leq p^{\text{init capacity}}_{\text{H2}} \cdot p^{\text{availability profile}}_{\text{H2},1:6} \\
\end{aligned}\]</p><h4 id="Transport-Capacity-Constraints"><a class="docs-heading-anchor" href="#Transport-Capacity-Constraints">Transport Capacity Constraints</a><a id="Transport-Capacity-Constraints-1"></a><a class="docs-heading-anchor-permalink" href="#Transport-Capacity-Constraints" title="Permalink"></a></h4><p>For the connection from the hub to the demand, there are associated transmission capacity constraints, which are in the same resolution as the flow:</p><p class="math-container">\[\begin{aligned}
&amp; \text{max\_transport\_flows\_limit}_{(\text{balance},\text{demand}),1:3}: \\
&amp; \qquad v^{\text{flow}}_{(\text{balance},\text{demand}),1:3} \leq p^{\text{init export capacity}}_{(\text{balance},\text{demand})} \\
&amp; \text{max\_transport\_flows\_limit}_{(\text{balance},\text{demand}),4:6}: \\
&amp; \qquad v^{\text{flow}}_{(\text{balance},\text{demand}),4:6} \leq p^{\text{init export capacity}}_{(\text{balance},\text{demand})} \\
\end{aligned}\]</p><p class="math-container">\[\begin{aligned}
&amp; \text{min\_transport\_flows\_limit}_{(\text{balance},\text{demand}),1:3}: \\
&amp; \qquad v^{\text{flow}}_{(\text{balance},\text{demand}),1:3} \geq - p^{\text{init import capacity}}_{(\text{balance},\text{demand})} \\
&amp; \text{min\_transport\_flows\_limit}_{(\text{balance},\text{demand}),4:6}: \\
&amp; \qquad v^{\text{flow}}_{(\text{balance},\text{demand}),4:6} \geq - p^{\text{init import capacity}}_{(\text{balance},\text{demand})} \\
\end{aligned}\]</p><h3 id="Storage-Level-limits"><a class="docs-heading-anchor" href="#Storage-Level-limits">Storage Level limits</a><a id="Storage-Level-limits-1"></a><a class="docs-heading-anchor-permalink" href="#Storage-Level-limits" title="Permalink"></a></h3><p>Since the system has a storage asset, we must limit the maximum storage level. The <code>phs</code> time resolution is defined for every 6 hours, so we only have one constraint.</p><p class="math-container">\[\begin{aligned}
&amp; \text{max\_storage\_level\_limit}_{\text{phs},1:6}: \\
&amp; \qquad v^{\text{intra-storage}}_{\text{phs},1:6} \leq p^{\text{init storage capacity}}_{\text{phs}}
\end{aligned}\]</p><h3 id="comparison"><a class="docs-heading-anchor" href="#comparison">Comparison of Different Modeling Approaches</a><a id="comparison-1"></a><a class="docs-heading-anchor-permalink" href="#comparison" title="Permalink"></a></h3><p>This section quantifies the advantages of the <a href="#flex-asset-connection"><code>flexible connection</code></a> and <a href="#flex-time-res"><code>flexible time resolution</code></a> in the <em>TulipaEnergyModel.jl</em> modeling approach. So, let us consider three different approaches based on the same example:</p><ol><li>Classic approach with hourly resolution: This approach needs an extra asset, <code>node</code>, to create the hybrid operation of the <code>phs</code> and <code>wind</code> assets.</li><li>Flexible connection with hourly resolution: This approach uses the flexible connection to represent the hybrid operation of the <code>phs</code> and <code>wind</code> assets.</li><li>Flexible connection and flexible time: This approach uses both features, the flexible connection and the flexible time resolution.</li></ol><blockquote><p><strong>Note:</strong> The flexibility of <em>TulipaEnergyModel.jl</em> allows any of these three modeling approaches.</p></blockquote><p>The table below shows the constraints and variables for each approach over a 6-hour horizon. These results show the potential of flexible connections and time resolution for reducing the size of the optimization model.</p><table><tr><th style="text-align: left">Modeling approach</th><th style="text-align: left">Nº Variables</th><th style="text-align: left">Nº Constraints</th><th style="text-align: left">Objective Function</th></tr><tr><td style="text-align: left">Classic approach with hourly resolution</td><td style="text-align: left">48</td><td style="text-align: left">84</td><td style="text-align: left">28.4365</td></tr><tr><td style="text-align: left">Flexible connection with hourly resolution</td><td style="text-align: left">42</td><td style="text-align: left">72</td><td style="text-align: left">28.4365</td></tr><tr><td style="text-align: left">Flexible connection and time resolution</td><td style="text-align: left">16</td><td style="text-align: left">29</td><td style="text-align: left">28.4587</td></tr></table><p>By comparing the classic approach with the other methods, we can analyze their differences:</p><ul><li>The flexible connection with hourly resolution reduces 6 variables (<span>$12.5\%$</span>) and 12 constraints (<span>$\approx 14\%$</span>). Notice that we include the 6 extra constraints related to not allowing charging from the grid, although these constraints can also be modeled as bounds. Finally, the objective function value is the same, since we use an hourly time resolution in both cases.</li><li>The combination of features reduces 32 variables (<span>$\approx 67\%$</span>) and 55 constraints (<span>$\approx 65\%$</span>) with an approximation error of <span>$\approx 0.073\%$</span>.</li></ul><p>The level of reduction and approximation error will depend on the case study. Some cases that would benefit from this feature include:</p><ul><li><p>Coupling different energy sectors with various dynamics. For instance, methane, hydrogen, and heat sectors can be represented in energy models with lower resolutions (e.g., 4, 6, or 12h) than the electricity sector, usually modeled in higher resolutions (e.g., 1h, 30 min).</p></li><li><p>Having high resolutions for all assets in a large-scale case study may not be necessary. For example, if analyzing a European case study focusing on a specific country like The Netherlands, hourly details for distant countries (such as Portugal and Spain) may not be required. However, one would still want to consider their effect on The Netherlands without causing too much computational burden. In such cases, flexible time resolution can maintain hourly details in the focus country, while reducing the detail in distant countries by increasing their resolution (to two hours or more). This reduction allows a broader scope without over-burdening computation.</p></li></ul><h2 id="storage-modeling"><a class="docs-heading-anchor" href="#storage-modeling">Storage Modeling</a><a id="storage-modeling-1"></a><a class="docs-heading-anchor-permalink" href="#storage-modeling" title="Permalink"></a></h2><p>Energy storage systems can be broadly classified into two categories: seasonal and non-seasonal storage. Seasonal storage refers to assets that can store energy for more extended periods, usually spanning months or even years. Examples of such assets include hydro reservoirs, hydrogen storage in salt caverns, or empty gas fields. On the other hand, non-seasonal storage refers to assets that can store energy only for a few hours, such as batteries or small pumped-hydro storage units.</p><p>Both storage categories can be represented in <em>TulipaEnergyModel.jl</em> using the representative periods approach:</p><ul><li><em>Non-seasonal storage</em>: When the storage capacity of an asset is lower than the total length of representative periods, like in the case of a battery with a storage capacity of 4 hours and representative periods of 24-hour timesteps, intra-temporal constraints should be applied.</li><li><em>Seasonal storage</em>: When the storage capacity of an asset is greater than the total length of representative periods, like in the case of a hydroplant with a storage capacity of a month and representative periods of 24-hour timesteps, inter-temporal constraints should be applied.</li></ul><p>The equations of intra- and inter-temporal constraints for energy storage are available in the <a href="../formulation/#formulation"><code>mathematical formulation</code></a>. An example is shown in the following section to explain these concepts. In addition, the section <a href="../how-to-use/#seasonal-setup"><code>seasonal and non-seasonal storage setup</code></a> shows how to set the parameters in the model to consider each type in the storage assets.</p><h3 id="Example-to-Model-Seasonal-and-Non-seasonal-Storage"><a class="docs-heading-anchor" href="#Example-to-Model-Seasonal-and-Non-seasonal-Storage">Example to Model Seasonal and Non-seasonal Storage</a><a id="Example-to-Model-Seasonal-and-Non-seasonal-Storage-1"></a><a class="docs-heading-anchor-permalink" href="#Example-to-Model-Seasonal-and-Non-seasonal-Storage" title="Permalink"></a></h3><p>We use the example in the folder <a href="https://github.com/TulipaEnergy/TulipaEnergyModel.jl/tree/main/test/inputs/Storage"><code>test/inputs/Storage</code></a> to explain how all these concepts come together in <em>TulipaEnergyModel.jl</em>.</p><p>Let&#39;s first look at this feature&#39;s most relevant input data, starting with the <code>assets-data</code> file. Here, we show only the storage assets and the appropriate columns for this example, but all the input data can be found in the previously mentioned folder.</p><div><div style = "float: left;"><span>2×6 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">name</th><th style = "text-align: left;">type</th><th style = "text-align: left;">initial_capacity</th><th style = "text-align: left;">is_seasonal</th><th style = "text-align: left;">initial_storage_capacity</th><th style = "text-align: left;">initial_storage_level</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "InlineStrings.String7" style = "text-align: left;">String7</th><th title = "InlineStrings.String15" style = "text-align: left;">String15</th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Bool" style = "text-align: left;">Bool</th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Int64" style = "text-align: left;">Int64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">battery</td><td style = "text-align: left;">storage</td><td style = "text-align: right;">10</td><td style = "text-align: right;">false</td><td style = "text-align: right;">20</td><td style = "text-align: right;">0</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">phs</td><td style = "text-align: left;">storage</td><td style = "text-align: right;">100</td><td style = "text-align: right;">true</td><td style = "text-align: right;">4800</td><td style = "text-align: right;">2400</td></tr></tbody></table></div><p>The <code>is_seasonal</code> parameter determines whether or not the storage asset uses the inter-temporal constraints. The <code>phs</code> is the only storage asset with this type of constraint and inter-storage level variable (i.e., <span>$v^{\text{inter-storage}}_{\text{phs},p}$</span>), and has 100MW capacity and 4800MWh of storage capacity (i.e., 48h discharge duration). The <code>battery</code> will only consider intra-temporal constraints with intra-storage level variables (i.e., <span>$v^{\text{intra-storage}}_{\text{battery},k,b_k}$</span>), and has 10MW capacity with 20MWh of storage capacity (i.e., 2h discharge duration).</p><p>The <code>rep-periods-data</code> file has information on the representative periods in the example. We have three representative periods, each with 24 timesteps and hourly resolution, representing a day. The figure below shows the availability profile of the renewable energy sources in the example.</p><div><div style = "float: left;"><span>3×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">rep_period</th><th style = "text-align: left;">num_timesteps</th><th style = "text-align: left;">resolution</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">1</td><td style = "text-align: right;">24</td><td style = "text-align: right;">1.0</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: right;">2</td><td style = "text-align: right;">24</td><td style = "text-align: right;">1.0</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: right;">3</td><td style = "text-align: right;">24</td><td style = "text-align: right;">1.0</td></tr></tbody></table></div><p><img src="../figs/availability-profiles.png" alt="availability-profiles"/></p><p>The <code>rep-periods-mapping</code> relates each representative period with the periods in the timeframe. We have seven periods in this case, meaning the timeframe is a week. Each value in the file indicates the weight of each representative period in the timeframe period. Notice that each period is composed of a linear combination of the representative periods. For more details on obtaining the representative periods and the weights, please look at <a href="https://github.com/TulipaEnergy/TulipaClustering.jl"><em>TulipaClustering.jl</em></a>. For the sake of readability, we show here the information in the file in tabular form:</p><div><div style = "float: left;"><span>7×4 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">period</th><th style = "text-align: left;">k=1</th><th style = "text-align: left;">k=2</th><th style = "text-align: left;">k=3</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "Int64" style = "text-align: left;">Int64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: right;">1</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">1.0</td><td style = "text-align: right;">0.0</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: right;">2</td><td style = "text-align: right;">0.2</td><td style = "text-align: right;">0.7</td><td style = "text-align: right;">0.1</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: right;">3</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">0.8</td><td style = "text-align: right;">0.2</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: right;">4</td><td style = "text-align: right;">0.3</td><td style = "text-align: right;">0.6</td><td style = "text-align: right;">0.1</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: right;">5</td><td style = "text-align: right;">0.1</td><td style = "text-align: right;">0.6</td><td style = "text-align: right;">0.3</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: right;">6</td><td style = "text-align: right;">0.1</td><td style = "text-align: right;">0.3</td><td style = "text-align: right;">0.6</td></tr><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: right;">7</td><td style = "text-align: right;">0.8</td><td style = "text-align: right;">0.2</td><td style = "text-align: right;">0.0</td></tr></tbody></table></div><p>The file <code>assets-timeframe-partitions</code> has the information on how often we want to evaluate the inter-temporal constraints that combine the information of the representative periods. In this example, we define a uniform distribution of one period, meaning that we will check the inter-storage level every day of the week timeframe.</p><div><div style = "float: left;"><span>1×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "header"><th class = "rowNumber" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">asset</th><th style = "text-align: left;">specification</th><th style = "text-align: left;">partition</th></tr><tr class = "subheader headerLastRow"><th class = "rowNumber" style = "font-weight: bold; text-align: right;"></th><th title = "InlineStrings.String3" style = "text-align: left;">String3</th><th title = "InlineStrings.String7" style = "text-align: left;">String7</th><th title = "Int64" style = "text-align: left;">Int64</th></tr></thead><tbody><tr><td class = "rowNumber" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">phs</td><td style = "text-align: left;">uniform</td><td style = "text-align: right;">1</td></tr></tbody></table></div><blockquote><p><strong>Note:</strong> For the sake of simplicity, we show how using three representative days can recover part of the chronological information of one week. The same method can be applied to more representative periods to analyze the seasonality across a year or longer timeframe.</p></blockquote><p>Now let&#39;s solve the example and explore the results:</p><pre><code class="language-julia hljs">using TulipaEnergyModel

# input_dir should be the path to the Storage example
energy_problem = run_scenario(input_dir)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">EnergyProblem:
  - Time for reading the data (in seconds): 8.080309337
  - Model created!
    - Time for creating the model (in seconds): 5.95675853
    - Number of variables: 727
    - Number of constraints for variable bounds: 727
    - Number of structural constraints: 957
  - Model solved! 
    - Time for solving the model (in seconds): 1.544078319
    - Termination status: OPTIMAL
    - Objective value: 2409.384029344029
</code></pre><p>Since the <code>battery</code> is not seasonal, it only has results for the intra-storage level of each representative period, as shown in the following figure:</p><p><img src="../figs/intra-storage-level.png" alt="Battery-intra-storage-level"/></p><p>Since the <code>phs</code> is defined as seasonal, it has results for only the inter-storage level. Since we defined the period partition as 1, we get results for each period (i.e., day). We can see that the inter-temporal constraints in the model keep track of the storage level through the whole timeframe definition (i.e., week).</p><p><img src="../figs/inter-storage-level.png" alt="PHS-inter-storage-level"/></p><p>In this example, we have demonstrated how to partially recover the chronological information of a storage asset with a longer discharge duration (such as 48 hours) than the representative period length (24 hours). This feature enables us to model both short- and long-term storage in <em>TulipaEnergyModel.jl</em>.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorials/">« Tutorials</a><a class="docs-footer-nextpage" href="../formulation/">Mathematical Formulation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Wednesday 26 June 2024 09:54">Wednesday 26 June 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
